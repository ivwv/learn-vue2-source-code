{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../src/initState.js","../src/init.js","../src/index.js"],"sourcesContent":["export function observer(data) {\r\n  //   console.log(data)\r\n  // 1.判断\r\n  if (typeof data != 'object' || data == null) {\r\n    return data\r\n  }\r\n  //   是对象的形式\r\n  return new Observer(data)\r\n}\r\nclass Observer {\r\n  constructor(value) {\r\n    // 判断数据\r\n    console.log(value)\r\n    if (Array.isArray(value)) {\r\n      console.log('数组')\r\n    } else {\r\n      this.walk(value) // 遍历\r\n    }\r\n  }\r\n  walk(data) {\r\n    let keys = Object.keys(data)\r\n    for (let i = 0; i < keys.length; i++) {\r\n      //将每一个数据拿出来 对每一个属性进行劫持\r\n      let key = keys[i] //data每一个键\r\n      let value = data[key] //通过键获取每一个值\r\n      //   数据劫持方法\r\n      defineReactive(data, key, value)\r\n    }\r\n  }\r\n}\r\n\r\n// 对对象中的属性进行劫持\r\nfunction defineReactive(data, key, value) {\r\n  //{a:{b:1}}\r\n  /**\r\n   * 问题一\r\n   * 由于 Object.defineProperty() 只能代理第一层的数据,只能对对象中的一个属性进行劫持\r\n   * 假如对象内还嵌套了一层对象，这不能代理\r\n   * 此时需要进行递归代理\r\n   * 由于 该文件内 的 observer() 方法 传递的是一个data 对象\r\n   * 此方法内的value也是传递过来的对象，所以可以将 value 传递过来再调用 observer() 方法\r\n   *\r\n   */\r\n  // 深度代理 递归\r\n  observer(value)\r\n\r\n  Object.defineProperty(data, key, {\r\n    // 获取触发\r\n    get() {\r\n      console.log('获取')\r\n      return value\r\n    },\r\n    // 设置触发\r\n    set(newValue) {\r\n      console.log('设置值')\r\n      // 判断新值是否和旧值一样 ，一样就返回\r\n      if (newValue == value) return\r\n      /**\r\n       * 问题二\r\n       * 当修改为对象时，再调用 observer() 方法进行新对象代理\r\n       */\r\n      observer(newValue) // 如果用户设置的值是对象就进行递归\r\n      value = newValue\r\n    },\r\n  })\r\n}\r\n\r\n// vue2  Object.defineProperty 缺点 对象中的一个属性进行劫持 {a:1,b:2}\r\n\r\n// 数组形式 {list:[1,2,3,4],arr:[{a:1}]}\r\n// 方法函数劫持 , 重写数组方法 arr.push()  就是对 arr.push()经行劫持\r\n","import { observer } from './observe/index.js'\r\n\r\nexport function initState(vm) {\r\n  let opts = vm.$options\r\n  //   console.log(opts)\r\n  //   判断\r\n  if (opts.props) {\r\n    initProps(vm)\r\n  }\r\n  if (opts.data) {\r\n    initData(vm)\r\n  }\r\n  if (opts.watch) {\r\n    initWatch(vm)\r\n  }\r\n  if (opts.computed) {\r\n    initComputed(vm)\r\n  }\r\n  if (opts.methods) {\r\n    initMethods(vm)\r\n  }\r\n}\r\n\r\nfunction initComputed(vm) {}\r\nfunction initMethods(vm) {}\r\nfunction initProps(vm) {}\r\nfunction initWatch(vm) {}\r\n\r\n// 对data进行初始化\r\nfunction initData(vm) {\r\n  // console.log('data初始化')\r\n  let data = vm.$options.data\r\n  data = vm._data = typeof data === 'function' ? data.call(vm) : data\r\n  //   console.log(data)\r\n  // 对数据进行劫持\r\n  observer(data)\r\n}\r\n","import { initState } from './initState'\r\n\r\nexport function initMixin(Vue) {\r\n  Vue.prototype._init = function (options) {\r\n    // console.log(options)\r\n    let vm = this\r\n    vm.$options = options\r\n    // 初始化状态\r\n    initState(vm)\r\n  }\r\n}\r\n","import { initMixin } from './init'\r\n\r\nfunction Vue(options) {\r\n  //   console.log(options);\r\n  //   初始化\r\n  this._init(options)\r\n}\r\n\r\ninitMixin(Vue)\r\n\r\nexport default Vue\r\n"],"names":[],"mappings":"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"}